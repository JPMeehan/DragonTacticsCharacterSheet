<input type="hidden" name="attr_version" value="3.6.0" />
<div class="main">
    <div class="header section">
        <h1>Dragon Tactics Character Sheet</h1>
        <input type="text" name="attr_character_name" placeholder="Name" />
    </div>
    <div class="common section">
        <h2>Basic Info</h2>
        <input type="text" name="attr_gender" placeholder="Gender" class="gender" />
        <input type="text" name="attr_race" placeholder="Race" class="race" />
        <input type="checkbox" class="toggle" title="More qualities" />
        <div class="body">
            <input type="text" name="attr_height" placeholder="Height" class="bio" />
            <input type="text" name="attr_weight" placeholder="Weight" class="bio" />
            <textarea placeholder="Character Description"></textarea>
        </div>
        <input type="text" name="attr_class" placeholder="Class" /> <input type="number" name="attr_level" value="1"
            min="1" max="30" />
        <label class="inline">
            Quest Bonus <input type="number" name="attr_quest" value="0" />
        </label>
        <input type="hidden" name="attr_actionpoints" value="1" />
        <input type="hidden" name="attr_actionpoints_max" value="1" />
    </div>
    <div class="abilities section">
        <h2>Attributes</h2>
        <div class="attributebox">
            <div class="ability strength numblock">
                <label class="ability">
                    Strength
                    <input type="radio" value="Strength" name="attr_skilldisplay" class="skillradio" />
                </label>
                <input type="number" name="attr_strength" value="10" />
                <input name="attr_strmod" type="hidden" value="0" />
            </div>
            <div class="ability constitution numblock">
                <label class="ability">
                    Constitution
                    <input type="radio" value="Constitution" name="attr_skilldisplay" class="skillradio" />
                </label>
                <input type="number" name="attr_constitution" value="10" />
                <input name="attr_conmod" type="hidden" value="0" />
            </div>
            <div class="ability dexterity numblock">
                <label class="ability">
                    Dexterity
                    <input type="radio" value="Dexterity" name="attr_skilldisplay" class="skillradio" />
                </label>
                <input type="number" name="attr_dexterity" value="10" />
                <input name="attr_dexmod" type="hidden" value="0" />
            </div>
            <div class="ability intelligence numblock">
                <label class="ability">
                    Intelligence
                    <input type="radio" value="Intelligence" name="attr_skilldisplay" class="skillradio" />
                </label>
                <input type="number" name="attr_intelligence" value="10" />
                <input name="attr_intmod" type="hidden" value="0" />
            </div>
            <div class="ability wisdom numblock">
                <label class="ability">
                    Wisdom
                    <input type="radio" value="Wisdom" name="attr_skilldisplay" class="skillradio" />
                </label>
                <input type="number" name="attr_wisdom" value="10" />
                <input name="attr_wismod" type="hidden" value="0" />
            </div>
            <div class="ability charisma numblock">
                <label class="ability">
                    Charisma
                    <input type="radio" value="Charisma" name="attr_skilldisplay" class="skillradio" />
                </label>
                <input type="number" name="attr_charisma" value="10" />
                <input name="attr_chamod" type="hidden" value="0" />
            </div>
        </div>
        <div class="skillbox">
            <button type="roll"
                value="&{template:skillcheck} {{name=@{skilldisplay} Check}} {{check=[[1d20 @{abimod}]]}} {{checkadv=[[1d20 @{abimod}]]}}"
                class="abilitycheck numblock" name="roll_abilitycheck">
                <span name="attr_skilldisplay">Strength</span>
                <span name="attr_abimod" value="0" class="numblock-mod">0</span>
            </button>
            <input type="hidden" name="attr_skilldisplay" value="Strength" class="skilldisplay" />
            <input type="hidden" name="attr_skillconfig" class="skillconfig" />
            <div class="skill-group strength">
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Athletics Check}} {{Trained=@{athletics-trained}}} {{check=[[1d20 @{athletics}]]}} {{checkadv=[[1d20 @{athletics}]]}}"
                            name="roll_athleticscheck"> Athletics
                        <span name="attr_athletics" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Athletics</h4>
                        <select name="attr_athletics-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_athletics-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_athletics-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
            </div>
            <div class="skill-group constitution">
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Endurance Check}} {{Trained=@{endurance-trained}}} {{check=[[1d20 @{endurance}]]}} {{checkadv=[[1d20 @{endurance}]]}}"
                            name="roll_endurancecheck"> Endurance
                        <span name="attr_endurance" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Endurance</h4>
                        <select name="attr_endurance-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_endurance-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_endurance-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
            </div>
            <div class="skill-group dexterity">
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Acrobatics Check}} {{Trained=@{acrobatics-trained}}} {{check=[[1d20 @{acrobatics}]]}} {{checkadv=[[1d20 @{acrobatics}]]}}"
                            name="roll_acrobaticscheck"> Acrobatics
                        <span name="attr_acrobatics" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Acrobatics</h4>
                        <select name="attr_acrobatics-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_acrobatics-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_acrobatics-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Stealth Check}} {{Trained=@{stealth-trained}}} {{check=[[1d20 @{stealth}]]}} {{checkadv=[[1d20 @{stealth}]]}}"
                            name="roll_stealthcheck"> Stealth
                        <span name="attr_stealth" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Stealth</h4>
                        <select name="attr_stealth-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_stealth-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_stealth-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Sleight of Hand Check}} {{Trained=@{sleightofhand-trained}}} {{check=[[1d20 @{sleightofhand}]]}} {{checkadv=[[1d20 @{sleightofhand}]]}}"
                            name="roll_sleightofhandcheck"> Sleight of<br>Hand
                        <span name="attr_sleightofhand" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Sleight of Hand</h4>
                        <select name="attr_sleightofhand-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_sleightofhand-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_sleightofhand-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
            </div>
            <div class="skill-group intelligence">
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Arcana Check}} {{Trained=@{arcana-trained}}} {{check=[[1d20 @{arcana}]]}} {{checkadv=[[1d20 @{arcana}]]}}"
                            name="roll_arcanacheck"> Arcana
                        <span name="attr_arcana" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Arcana</h4>
                        <select name="attr_arcana-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_arcana-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_arcana-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Debate Check}} {{Trained=@{debate-trained}}} {{check=[[1d20 @{debate}]]}} {{checkadv=[[1d20 @{debate}]]}}"
                            name="roll_debatecheck"> Debate
                        <span name="attr_debate" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Debate</h4>
                        <select name="attr_debate-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_debate-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_debate-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Repair Check}} {{Trained=@{repair-trained}}} {{check=[[1d20 @{repair}]]}} {{checkadv=[[1d20 @{repair}]]}}"
                            name="roll_repaircheck"> Repair
                        <span name="attr_repair" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Repair</h4>
                        <select name="attr_repair-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_repair-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_repair-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Research Check}} {{Trained=@{research-trained}}} {{check=[[1d20 @{research}]]}} {{checkadv=[[1d20 @{research}]]}}"
                            name="roll_researchcheck"> Research
                        <span name="attr_research" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Research</h4>
                        <select name="attr_research-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_research-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_research-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
            </div>
            <div class="skill-group wisdom">
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Handle Animal Check}} {{Trained=@{handleanimal-trained}}} {{check=[[1d20 @{handleanimal}]]}} {{checkadv=[[1d20 @{handleanimal}]]}}"
                            name="roll_handleanimalcheck"> Handle<br>Animal
                        <span name="attr_handleanimal" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Handle Animal</h4>
                        <select name="attr_handleanimal-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_handleanimal-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_handleanimal-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Insight Check}} {{Trained=@{insight-trained}}} {{check=[[1d20 @{insight}]]}} {{checkadv=[[1d20 @{insight}]]}}"
                            name="roll_insightcheck"> Insight
                        <span name="attr_insight" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Insight</h4>
                        <select name="attr_insight-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_insight-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_insight-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Medicine Check}} {{Trained=@{medicine-trained}}} {{check=[[1d20 @{medicine}]]}} {{checkadv=[[1d20 @{medicine}]]}}"
                            name="roll_medicinecheck"> Medicine
                        <span name="attr_medicine" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Medicine</h4>
                        <select name="attr_medicine-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_medicine-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_medicine-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Perception Check}} {{Trained=@{perception-trained}}} {{check=[[1d20 @{perception}]]}} {{checkadv=[[1d20 @{perception}]]}}"
                            name="roll_perceptioncheck"> Perception
                        <span name="attr_perception" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Perception</h4>
                        <select name="attr_perception-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_perception-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_perception-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Survival Check}} {{Trained=@{survival-trained}}} {{check=[[1d20 @{survival}]]}} {{checkadv=[[1d20 @{survival}]]}}"
                            name="roll_survivalcheck"> Survival
                        <span name="attr_survival" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Survival</h4>
                        <select name="attr_survival-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_survival-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_survival-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
            </div>
            <div class="skill-group charisma">
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Appeal Check}} {{Trained=@{appeal-trained}}} {{check=[[1d20 @{appeal}]]}} {{checkadv=[[1d20 @{appeal}]]}}"
                            name="roll_appealcheck"> Appeal
                        <span name="attr_appeal" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Appeal</h4>
                        <select name="attr_appeal-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_appeal-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_appeal-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Impress Check}} {{Trained=@{impress-trained}}} {{check=[[1d20 @{impress}]]}} {{checkadv=[[1d20 @{impress}]]}}"
                            name="roll_impresscheck"> Impress
                        <span name="attr_impress" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Impress</h4>
                        <select name="attr_impress-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_impress-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_impress-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
                <div class="skill">
                    <div class="skilldisplay">
                        <button type="roll" class="skillcheckroll numblock"
                            value="&{template:skillcheck} {{name=Socialize Check}} {{Trained=@{socialize-trained}}} {{check=[[1d20 @{socialize}]]}} {{checkadv=[[1d20 @{socialize}]]}}"
                            name="roll_socializecheck"> Socialize
                        <span name="attr_socialize" value="+0" class="numblock-mod">+0</span>
                        </button>
                    </div>
                    <div class="skillconfig">
                        <h4>Socialize</h4>
                        <select name="attr_socialize-train" class="training">
                            <option value="0" selected>Untrained</option>
                            <option value="2">Adept</option>
                            <option value="4">Trained</option>
                            <option value="6">Experienced</option>
                            <option value="8">Expert</option>
                            <option value="10">Master</option>
                        </select>
                        <input type="number" name="attr_socialize-miscbonus" value="0" title="Misc. Bonus for things like youor Armor Check penalty"/>
                        <input name="attr_socialize-trained" type="hidden" value="Untrained" />
                    </div>
                </div>
            </div>
            <label class="skillconfig">
                Skill Config
                <input type="checkbox" name="attr_skillconfig" value="true" />
            </label>
        </div>
    </div>
    <div class="competencies section">
        <h2>Competencies</h2>
        <fieldset class="repeating_competencies">
            <input type="text" name="attr_competency" placeholder="Competency" />
        </fieldset>
    </div>
    <div class="defense section">
        <h2>Key Values</h2>
        <div class="hp">
            <h3>Hit Points</h3>
            <label class="numblock-container hp-setup" title="Click here to modify your max HP">
                <div class="numblock hp-max">
                    Max
                    <span name="attr_hp_max" value="20">20</span>
                </div>
                <input type="checkbox" class="toggle hidden"/>
                <div class="body">
                    <label class="numblock 3col">
                        Base
                        <input type="number" name="attr_hp-base" value="10"/>
                    </label>
                    <label class="numblock 3col">
                        Per level
                        <input type="number" name="attr_hp-level" value="5"/>
                    </label>
                    <label class="numblock 3col">
                        Bonus
                        <input type="number" name="attr_hp-bonus" value="0"/>
                    </label>
                </div>
            </label>
            <label class="numblock 3col">Current<input type="number" name="attr_hp" value="20" /></label>
            <label class="numblock 3col">Temporary<input type="number" name="attr_hp-temp" value="0" /></label>
            <label class="numblock 3col">Bloodied<input type="number" name="attr_hp-bloodied" value="10" /></label>
            <h3>Healing Surges</h3>
            <label class="numblock 3col">Surge Value<input type="number" name="attr_hp-surgevalue" value="5" /></label>
            <label class="numblock 3col">Current<input type="number" name="attr_surges" value="6" /></label>
            <label class="numblock 3col">Max<input type="number" name="attr_surges_max" value="6" /></label>
        </div>
        <div class="armor">
            <h3>Defenses</h3>
            <label class="numblock-container AC" title="Click here to add misc bonuses">
                <div class="numblock defense-block">
                    Armor Class
                    <span name="attr_ac" value="10" class="defense">10</span>
                </div>
                <input type="checkbox" class="toggle hidden" title="Show Details">
                <div class="body">
                    <label class="miscbonus" title="Miscellaneous AC bonuses">
                        Bonus <input type="number" name="attr_ac-misc" value="0" />
                    </label>
                </div>
            </label>
            <label class="numblock-container NAD" title="Click here to add misc bonuses">
                <div class="numblock defense-block">
                    Fortitude
                    <span name="attr_fort" value="10" class="defense" >10</span>
                </div>
                <input type="checkbox" class="toggle hidden" title="Show Details">
                <div class="body">
                    <label class="miscbonus" title="Miscellaneous Fortitude bonuses, like from your class">
                        Bonus
                        <input type="number" name="attr_fort-misc" value="0" />
                    </label>
                </div>
            </label>
            <label class="numblock-container NAD" title="Click here to add misc bonuses">
                <div class="numblock defense-block">
                    Reflex
                    <span name="attr_ref" value="10" class="defense" >10</span>
                </div>
                <input type="checkbox" class="toggle hidden" title="Show Details">
                <div class="body">
                    <label class="miscbonus" title="Miscellaneous Reflex bonuses, like from your class">
                        Bonus
                        <input type="number" name="attr_ref-misc" value="0" />
                    </label>
                </div>
            </label>
            <label class="numblock-container NAD" title="Click here to add misc bonuses">
                <div class="numblock defense-block">
                    Will
                    <span name="attr_will" value="10" class="defense" >10</span>
                </div>
                <input type="checkbox" class="toggle hidden" title="Show Details">
                <div class="body">
                    <label class="miscbonus" title="Miscellaneous Will bonuses, like from your class">
                        Bonus
                        <input type="number" name="attr_will-misc" value="0" />
                    </label>
                </div>
            </label>
        </div>
    </div>
    <div class="effects section">
        <h2>Stats</h2>
        <h3>Movement</h3>
        <input type="text" name="attr_speed" class="speed" placeholder="30 feet" />
        <div class="bonusdice">
            <button type="roll" class="bonusdice-roll" name="roll_bonusdice"
                value="&{template:damage} {{name=Bonus Dice}} {{damage=[[@{bonusdice-entry}]]}} {{dmgcrit=[[@{bonusdice-crit}]]}}">
                Bonus Dice
            </button>
            <input type="text" name="attr_bonusdice-entry" placeholder="1d8" />
            <input type="hidden" value="0" name="attr_bonusdice-crit" />
        </div>
        <div class="powerpoints right">
            <h3>Resource</h3>
            <input type="number" value="0" name="attr_powerpoints" /> /
            <input type="number" value="0" name="attr_powerpoints_max" />
        </div>
        <div class="healing">
            <h3>Healing</h3>
            <button type="roll" value="&{template:healing} {{name=Second Wind}} {{name=Name}} {{surge=[[@{hp-surgevalue}]]}} {{powertext=You spend a healing surge and gain a +2 bonus to all defenses until the end of the next round.}}">Second Wind</button>
            <input type="text" name="attr_healing-name" placeholder="Healing Power Name" class="healing-name"/>
            <input type="checkbox" class="toggle"/>
            <div class="body">
                <button type="roll" value="&{template:healing} {{name=@{healing-name}}} {{dice=[[@{healing-dice}]]}} {{surge=[[@{target|hp-surgevalue}]]}} {{powertext=@{healing-description}}}">Heal Target</button>
                <input type="text" name="attr_healing-dice" placeholder="Healing Dice" value="1d6" class="healing-dice"/>
                <textarea name="attr_healing-description" placeholder="Healing Power Description"></textarea>
            </div>
        </div>
        <h3>Persistent Effects</h3>
        <div class="persistent-effect-block">
            <textarea name="attr_persistent-effect-text" placeholder="Status Effects, Buffs, etc."></textarea>
        </div>
    </div>
    <div class="standard section">
        <h2>Standard Actions</h2>
        <fieldset class="repeating_standard">
            <input type="text" name="attr_standard-name" placeholder="Power Name" class="powername" />
            <input type="checkbox" value="1" checked="true" name="attr_standard-display" class="toggle"
                title="Show Details" />
            <div class="body">
                <label class="inline">
                    Recharge
                    <select name="attr_standard-usage" class="usage">
                        <option value="At-Will">At-Will</option>
                        <option value="Encounter">Encounter</option>
                        <option value="Daily">Daily</option>
                    </select>
                </label>
                <label title="Range and Targets">
                    Range and Targets
                    <input type="text" name="attr_standard-rangetargets" class="rangetargets" placeholder="Melee One Creature" />
                </label>
                <button type="roll" class="combatroll" name="roll_standard-textout"
                    value="&{template:powertext} {{name=@{standard-name}}} {{powertext=@{standard-power-text}}}">
                    Power Text
                </button>
                <textarea name="attr_standard-power-text" placeholder="Effect: Create a zone"></textarea>
                <div class="attackroll">
                    <input type="hidden" name="attr_standard-hitbonus" value="+0" />
                    <button type="roll" class="combatroll" name="roll_standard-attack"
                        value="&{template:attack} {{name=@{standard-name}}} {{RangeTargets=@{standard-rangetargets}}} {{attack=[[1d20 @{standard-hitbonus}]]}} {{attackadv=[[1d20 @{standard-hitbonus}]]}} {{edge=[[1d4]]}} {{defense=@{standard-defselect}}}"><span
                            name="attr_standard-hitbonus" value="+0">+0</span>
                        vs.
                        <span name="attr_standard-defselect">AC</span></button>
                </div>
                <div class="damageroll">
                    <input type="hidden" name="attr_standard-flatdamage" />
                    <button type="roll" class="combatroll" name="roll_standard-damage"
                        value="&{template:damage} {{name=@{standard-name}}} {{damage=[[@{standard-damagedice} @{standard-flatdamage}]]}} {{dmgcrit=[[@{standard-critdice} + @{standard-critflat} @{standard-flatdamage}]]}} {{dmgtype=@{standard-damagetype}}}"><span
                            name="attr_standard-damagedice" value="1d4">1d4</span><span value="0"
                            name="attr_standard-flatdamage" value="\+0">+0</span>
                        <span name="attr_standard-damagetype" value="Fire">Fire</span>
                        damage</button>
                </div>
                Setup
                <input type="checkbox" value="1" checked="true" name="attr_standard-setup-display" class="toggle"
                    title="Show Details" />
                <div class="body">
                    <select name="attr_standard-accessory" class="accesoryselect">
                        <option value="imp1"> Implement 1 </option>
                        <option value="imp2"> Implement 2 </option>
                        <option value="wep1"> Weapon 1 </option>
                        <option value="wep2"> Weapon 2 </option>
                        <option value="wep3"> Weapon 3 </option>
                    </select>
                    <br />
                    <select class="attselect" name="attr_standard-ability">
                        <option value="strmod" selected>Strength</option>
                        <option value="conmod">Constitution</option>
                        <option value="dexmod">Dexterity</option>
                        <option value="intmod">Intelligence</option>
                        <option value="wismod">Wisdom</option>
                        <option value="chamod">Charisma</option>
                    </select>
                    vs.
                    <span class="defselect">
                        <select name="attr_standard-defselect">
                            <option value="AC">AC</option>
                            <option value="Fort">Fortitude</option>
                            <option value="Ref">Reflex</option>
                            <option value="Will">Will</option>
                        </select>
                    </span>
                    <label title="Damage Dice">
                        Damage Dice
                        <input type="text" name="attr_standard-damagedice" class="diceinput" value="1d4" /></label>
                    <label title="Damage Type">
                        Damage Type
                        <input type="text" name="attr_standard-damagetype" class="diceinput" value="Fire" /></label>
                    <label title="Crit dice">
                        Crit Dice
                        <input type="text" value="1d4" class="diceinput" name="attr_standard-critdice" /></label>
                    <label title="Misc. Bonus to hit">
                        Misc Bonus to Hit
                        <input type="number" value="0" name="attr_standard-miscattackbonus" /></label>
                    <label title="Other damage bonuses, such as from feats">
                        Misc Flat Damage
                        <input type="number" name="attr_standard-miscdamage" value="0" />
                    </label>
                    <label title="For basic attacks that don't add the ability modifier to the damage roll">
                        Abi mod to damage
                        <input type="checkbox" name="attr_standard-abidamage" checked value=1 />
                    </label>
                    <input type="hidden" value="0" name="attr_standard-hitbonus-accessory" />
                    <input type="hidden" value="0" name="attr_standard-abimod" />
                    <input type="hidden" value="0" name="attr_standard-critflat" />
                </div>
            </div>
        </fieldset>
    </div>
    <div class="move section">
        <h2>Move Actions</h2>
        <fieldset class="repeating_move">
            <input type="text" name="attr_move-name" placeholder="Power Name" class="powername" />
            <input type="checkbox" value="1" checked="true" name="attr_move-display" class="toggle"
                title="Show Details" />
            <div class="body">
                <label class="inline">
                    Recharge
                    <select name="attr_move-usage" class="usage">
                        <option value="At-Will">At-Will</option>
                        <option value="Encounter">Encounter</option>
                        <option value="Daily">Daily</option>
                    </select>
                </label>
                <label title="Range and Targets">
                    Range and Targets
                    <input type="text" name="attr_move-rangetargets" class="rangetargets" placeholder="Personal" />
                </label>
                <button type="roll" class="combatroll" name="roll_move-textout"
                    value="&{template:powertext} {{name=@{move-name}}} {{powertext=@{move-power-text}}}">
                    Power Text
                </button>
                <textarea name="attr_move-power-text" placeholder="Effect: Shift your speed"></textarea>
                <div class="attackroll">
                    <input type="hidden" name="attr_move-hitbonus" value="+0" />
                    <button type="roll" class="combatroll" name="roll_move-attack"
                        value="&{template:attack} {{name=@{move-name}}} {{RangeTargets=@{move-rangetargets}}} {{attack=[[1d20 @{move-hitbonus}]]}} {{attackadv=[[1d20 @{move-hitbonus}]]}} {{defense=@{move-defselect}}} {{edge=[[1d4]]}}"><span
                            name="attr_move-hitbonus" value="+0">+0</span>
                        vs.
                        <span name="attr_move-defselect">AC</span></button>
                </div>
                <div class="damageroll">
                    <input type="hidden" name="attr_move-flatdamage" />
                    <button type="roll" class="combatroll" name="roll_move-damage"
                        value="&{template:damage} {{name=@{move-name}}} {{damage=[[@{move-damagedice} @{move-flatdamage}]]}} {{dmgcrit=[[@{move-critdice} + @{move-critflat} @{move-flatdamage}]]}} {{dmgtype=@{move-damagetype}}}"><span
                            name="attr_move-damagedice" value="1d4">1d4</span><span value="0"
                            name="attr_move-flatdamage" value="\+0">+0</span>
                        <span name="attr_move-damagetype" value="Fire">Fire</span>
                        damage</button>
                </div>
                Setup
                <input type="checkbox" value="1" checked="true" name="attr_move-setup-display" class="toggle"
                    title="Show Details" />
                <div class="body">
                    <select name="attr_move-accessory" class="accesoryselect">
                        <option value="imp1"> Implement 1 </option>
                        <option value="imp2"> Implement 2 </option>
                        <option value="wep1"> Weapon 1 </option>
                        <option value="wep2"> Weapon 2 </option>
                        <option value="wep3"> Weapon 3 </option>
                    </select>
                    <br />
                    <select class="attselect" name="attr_move-ability">
                        <option value="strmod" selected>Strength</option>
                        <option value="conmod">Constitution</option>
                        <option value="dexmod">Dexterity</option>
                        <option value="intmod">Intelligence</option>
                        <option value="wismod">Wisdom</option>
                        <option value="chamod">Charisma</option>
                    </select>
                    vs.
                    <span class="defselect">
                        <select name="attr_move-defselect">
                            <option value="AC">AC</option>
                            <option value="Fort">Fortitude</option>
                            <option value="Ref">Reflex</option>
                            <option value="Will">Will</option>
                        </select>
                    </span>
                    <label title="Damage Dice">
                        Damage Dice
                        <input type="text" name="attr_move-damagedice" class="diceinput" value="1d4" /></label>
                    <label title="Damage Type">
                        Damage Type
                        <input type="text" name="attr_move-damagetype" class="diceinput" value="Fire" /></label>
                    <label title="Crit dice">
                        Crit Dice
                        <input type="text" value="1d4" class="diceinput" name="attr_move-critdice" /></label>
                    <label title="Misc. Bonus to hit">
                        Misc Bonus to Hit
                        <input type="number" value="0" name="attr_move-miscattackbonus" /></label>
                    <label title="Other damage bonuses, such as from feats">
                        Misc Flat Damage
                        <input type="number" name="attr_move-miscdamage" value="0" />
                    </label>
                    <label title="For basic attacks that don't add the ability modifier to the damage roll">
                        Abi mod to damage
                        <input type="checkbox" name="attr_move-abidamage" checked value=1 />
                    </label>
                    <input type="hidden" value="0" name="attr_move-hitbonus-accessory" />
                    <input type="hidden" value="0" name="attr_move-abimod" />
                    <input type="hidden" value="0" name="attr_move-critflat" />
                </div>
            </div>
        </fieldset>
    </div>
    <div class="minor section">
        <h2>Minor Actions</h2>
        <fieldset class="repeating_minor">
            <input type="text" name="attr_minor-name" placeholder="Power Name" class="powername" />
            <input type="checkbox" value="1" checked="true" name="attr_minor-display" class="toggle"
                title="Show Details" />
            <div class="body">
                <label class="inline">
                    Recharge
                    <select name="attr_minor-usage" class="usage">
                        <option value="At-Will">At-Will</option>
                        <option value="Encounter">Encounter</option>
                        <option value="Daily">Daily</option>
                    </select>
                </label>
                <label title="Range and Targets">
                    Range and Targets
                    <input type="text" name="attr_minor-rangetargets" class="rangetargets" placeholder="Ranged Sight One Creature" />
                </label>
                <button type="roll" class="combatroll" name="roll_minor-textout"
                    value="&{template:powertext} {{name=@{minor-name}}} {{powertext=@{minor-power-text}}}">
                    Power Text
                </button>
                <textarea name="attr_minor-power-text" placeholder="Mark the target"></textarea>
                <div class="attackroll">
                    <input type="hidden" name="attr_minor-hitbonus" value="+0" />
                    <button type="roll" class="combatroll" name="roll_minor-attack"
                        value="&{template:attack} {{name=@{minor-name}}} {{RangeTargets=@{minor-rangetargets}}} {{attack=[[1d20 @{minor-hitbonus}]]}} {{attackadv=[[1d20 @{minor-hitbonus}]]}} {{defense=@{minor-defselect}}} {{edge=[[1d4]]}}"><span
                            name="attr_minor-hitbonus" value="+0">+0</span>
                        vs.
                        <span name="attr_minor-defselect">AC</span></button>
                </div>
                <div class="damageroll">
                    <input type="hidden" name="attr_minor-flatdamage" />
                    <button type="roll" class="combatroll" name="roll_minor-damage"
                        value="&{template:damage} {{name=@{minor-name}}} {{damage=[[@{minor-damagedice} @{minor-flatdamage}]]}} {{dmgcrit=[[@{minor-critdice} + @{minor-critflat} @{minor-flatdamage}]]}} {{dmgtype=@{minor-damagetype}}}"><span
                            name="attr_minor-damagedice" value="1d4">1d4</span><span value="0"
                            name="attr_minor-flatdamage" value="\+0">+0</span>
                        <span name="attr_minor-damagetype" value="Fire">Fire</span>
                        damage</button>
                </div>
                Setup
                <input type="checkbox" value="1" checked="true" name="attr_minor-setup-display" class="toggle"
                    title="Show Details" />
                <div class="body">
                    <select name="attr_minor-accessory" class="accesoryselect">
                        <option value="imp1"> Implement 1 </option>
                        <option value="imp2"> Implement 2 </option>
                        <option value="wep1"> Weapon 1 </option>
                        <option value="wep2"> Weapon 2 </option>
                        <option value="wep3"> Weapon 3 </option>
                    </select>
                    <br />
                    <select class="attselect" name="attr_minor-ability">
                        <option value="strmod" selected>Strength</option>
                        <option value="conmod">Constitution</option>
                        <option value="dexmod">Dexterity</option>
                        <option value="intmod">Intelligence</option>
                        <option value="wismod">Wisdom</option>
                        <option value="chamod">Charisma</option>
                    </select>
                    vs.
                    <span class="defselect">
                        <select name="attr_minor-defselect">
                            <option value="AC">AC</option>
                            <option value="Fort">Fortitude</option>
                            <option value="Ref">Reflex</option>
                            <option value="Will">Will</option>
                        </select>
                    </span>
                    <label title="Damage Dice">
                        Damage Dice
                        <input type="text" name="attr_minor-damagedice" class="diceinput" value="1d4" /></label>
                    <label title="Damage Type">
                        Damage Type
                        <input type="text" name="attr_minor-damagetype" class="diceinput" value="Fire" /></label>
                    <label title="Crit dice">
                        Crit Dice
                        <input type="text" value="1d4" class="diceinput" name="attr_minor-critdice" /></label>
                    <label title="Misc. Bonus to hit">
                        Misc Bonus to Hit
                        <input type="number" value="0" name="attr_minor-miscattackbonus" /></label>
                    <label title="Other damage bonuses, such as from feats">
                        Misc Flat Damage
                        <input type="number" name="attr_minor-miscdamage" value="0" />
                    </label>
                    <label title="For basic attacks that don't add the ability modifier to the damage roll">
                        Abi mod to damage
                        <input type="checkbox" name="attr_minor-abidamage" checked value=1 />
                    </label>
                    <input type="hidden" value="0" name="attr_minor-hitbonus-accessory" />
                    <input type="hidden" value="0" name="attr_minor-abimod" />
                    <input type="hidden" value="0" name="attr_minor-critflat" />
                </div>
            </div>
        </fieldset>
    </div>
    <div class="reaction section">
        <h2>Immediate Actions</h2>
        <fieldset class="repeating_reaction">
            <input type="text" name="attr_reaction-name" placeholder="Power Name" class="powername" />
            <input type="checkbox" value="1" checked="true" name="attr_reaction-display" class="toggle"
                title="Show Details" />
            <div class="body">
                <label class="inline">
                    Recharge
                    <select name="attr_reaction-usage" class="usage">
                        <option value="At-Will">At-Will</option>
                        <option value="Encounter">Encounter</option>
                        <option value="Daily">Daily</option>
                    </select>
                </label>
                <label>
                    Action
                    <select name="attr_reaction-action" class="action">
                        <option value="1">Immediate Interrupt</option>
                        <option value="2">Immediate Reaction</option>
                        <option value="3">Free Interrupt</option>
                        <option value="4">Free Reaction</option>
                    </select>
                </label>
                <label>
                    Trigger <input type="text" name="attr_reaction-trigger" placeholder="An Enemy Bloodies You" />
                </label>
                <label title="Range and Targets">
                    Range and Targets
                    <input type="text" name="attr_reaction-rangetargets" class="rangetargets" placeholder="The Triggering Enemy" />
                </label>
                <button type="roll" class="combatroll" name="roll_reaction-textout"
                    value="&{template:powertext} {{name=@{reaction-name}}} {{powertext=@{reaction-power-text}}}">
                    Power Text
                </button>
                <textarea name="attr_reaction-power-text" placeholder="You gain resistance"></textarea>
                <div class="attackroll">
                    <input type="hidden" name="attr_reaction-hitbonus" value="+0" />
                    <button type="roll" class="combatroll" name="roll_reaction-attack"
                        value="&{template:attack} {{name=@{reaction-name}}} {{RangeTargets=@{reaction-rangetargets}}} {{attack=[[1d20 @{reaction-hitbonus}]]}} {{attackadv=[[1d20 @{reaction-hitbonus}]]}} {{defense=@{reaction-defselect}}} {{edge=[[1d4]]}}"><span
                            name="attr_reaction-hitbonus" value="+0">+0</span>
                        vs.
                        <span name="attr_reaction-defselect">AC</span></button>
                </div>
                <div class="damageroll">
                    <input type="hidden" name="attr_reaction-flatdamage" />
                    <button type="roll" class="combatroll" name="roll_reaction-damage"
                        value="&{template:damage} {{name=@{reaction-name}}} {{damage=[[@{reaction-damagedice} @{reaction-flatdamage}]]}} {{dmgcrit=[[@{reaction-critdice} + @{reaction-critflat} @{reaction-flatdamage}]]}} {{dmgtype=@{reaction-damagetype}}}"><span
                            name="attr_reaction-damagedice" value="1d4">1d4</span><span value="0"
                            name="attr_reaction-flatdamage" value="\+0">+0</span>
                        <span name="attr_reaction-damagetype" value="Fire">Fire</span>
                        damage</button>
                </div>
                Setup
                <input type="checkbox" value="1" checked="true" name="attr_reaction-setup-display" class="toggle"
                    title="Show Details" />
                <div class="body">
                    <select name="attr_reaction-accessory" class="accesoryselect">
                        <option value="imp1"> Implement 1 </option>
                        <option value="imp2"> Implement 2 </option>
                        <option value="wep1"> Weapon 1 </option>
                        <option value="wep2"> Weapon 2 </option>
                        <option value="wep3"> Weapon 3 </option>
                    </select>
                    <br />
                    <select class="attselect" name="attr_reaction-ability">
                        <option value="strmod" selected>Strength</option>
                        <option value="conmod">Constitution</option>
                        <option value="dexmod">Dexterity</option>
                        <option value="intmod">Intelligence</option>
                        <option value="wismod">Wisdom</option>
                        <option value="chamod">Charisma</option>
                    </select>
                    vs.
                    <span class="defselect">
                        <select name="attr_reaction-defselect">
                            <option value="AC">AC</option>
                            <option value="Fort">Fortitude</option>
                            <option value="Ref">Reflex</option>
                            <option value="Will">Will</option>
                        </select>
                    </span>
                    <label title="Damage Dice">
                        Damage Dice
                        <input type="text" name="attr_reaction-damagedice" class="diceinput" value="1d4" /></label>
                    <label title="Damage Type">
                        Damage Type
                        <input type="text" name="attr_reaction-damagetype" class="diceinput" value="Fire" /></label>
                    <label title="Crit dice">
                        Crit Dice
                        <input type="text" value="1d4" class="diceinput" name="attr_reaction-critdice" /></label>
                    <label title="Misc. Bonus to hit">
                        Misc Bonus to Hit
                        <input type="number" value="0" name="attr_reaction-miscattackbonus" /></label>
                    <label title="Other damage bonuses, such as from feats">
                        Misc Flat Damage
                        <input type="number" name="attr_reaction-miscdamage" value="0" />
                    </label>
                    <label title="For basic attacks that don't add the ability modifier to the damage roll">
                        Abi mod to damage
                        <input type="checkbox" name="attr_reaction-abidamage" checked value=1 />
                    </label>
                    <input type="hidden" value="0" name="attr_reaction-hitbonus-accessory" />
                    <input type="hidden" value="0" name="attr_reaction-abimod" />
                    <input type="hidden" value="0" name="attr_reaction-critflat" />
                </div>
            </div>
        </fieldset>
    </div>
    <div class="features section">
        <h2>Features</h2>
        <h3>Race Features</h3>
        <fieldset class="repeating_racefeatures">
            <input type="text" name="attr_racefeature-name" placeholder="Darkvision" /> <input type="checkbox"
                class="toggle" title="Show Details">
            <div class="body">
                <textarea name="attr_racefeature-description" placeholder="Item Description"></textarea>
            </div>
        </fieldset>
        <h3>Class Features</h3>
        <fieldset class="repeating_classfeatures">
            <input type="text" name="attr_classfeature-name" placeholder="Magic" /> <input type="checkbox" class="toggle"
                title="Show Details">
            <div class="body">
                <textarea name="attr_classfeature-description" placeholder="Item Description"></textarea>
            </div>
        </fieldset>
        <h3>Feats</h3>
        <fieldset class="repeating_feats">
            <input type="text" name="attr_feat-name" placeholder="Toughness" /> <input type="checkbox" class="toggle"
                title="Show Details">
            <div class="body">
                <textarea name="attr_feat-description" placeholder="Item Description"></textarea>
            </div>
        </fieldset>
        <h3>Flaws and Longterm Conditions</h3>
        <fieldset class="repeating_flaws_longtermconditions">
            <input type="text" name="attr_flaws_longtermcondition-name" placeholder="Mummy Rot" /> <input
                type="checkbox" class="toggle" title="Show Details">
            <div class="body">
                <textarea name="attr_flaws_longtermcondition-description" placeholder="Item Description"></textarea>
            </div>
        </fieldset>
    </div>
    <div class="worn section">
        <h2>Worn Equipment</h2>
        <div class="weapon">
            <h3>Weapon 1</h3>
            <input type="text" name="attr_wep1-name" class="item" placeholder="Longsword" />
            <input type="checkbox" class="toggle" />
            <div class="body">
                <div class="weapon-left">
                    <button type="roll" class="weaponba"
                        value="&{template:attack} {{name=@{wep1-name}}} {{RangeTargets=@{wep1-range}}} {{attack=[[1d20 + @{wep1-hitbonus}]]}} {{attackadv=[[1d20 + @{wep1-hitbonus}]]}} {{edge=[[1d4]]}} {{defense=AC}}"
                        name="roll_wep1-basic">
                        Basic Attack
                    </button>
                    <input type="text" name="attr_wep1-range" placeholder="Melee 5'" class="weaponrange" />
                    <select class="attselect" name="attr_wep1-ability">
                        <option value="strmod" selected>Strength</option>
                        <option value="conmod">Constitution</option>
                        <option value="dexmod">Dexterity</option>
                        <option value="intmod">Intelligence</option>
                        <option value="wismod">Wisdom</option>
                        <option value="chamod">Charisma</option>
                    </select>
                    <input type="hidden" name="attr_wep1-abimod" value="0" />
                    <input type="hidden" name="attr_wep1-hitbonus" value="0" />
                    <label class="small proficiency right">Proficiency
                        <input type="number" name="attr_wep1-prof" value="2" min=0 max=9 /></label>
                    <select class="weapon" name="attr_wep1-group">
                        <option value="Slashing">Axe</option>
                        <option value="Piercing">Bow</option>
                        <option value="Piercing">Crossbow</option>
                        <option value="Piercing">Flail</option>
                        <option value="Bludgeoning">Hammer</option>
                        <option value="Slashing" selected>Heavy Blade</option>
                        <option value="Piercing">Light Blade</option>
                        <option value="Bludgeoning">Mace</option>
                        <option value="Piercing">Pick</option>
                        <option value="Bludgeoning">Sling</option>
                        <option value="Piercing">Spear</option>
                        <option value="Bludgeoning">Staff</option>
                    </select>
                </div>
                <div class="weapon-right">
                    <button type="roll" class="weaponbd"
                        value="&{template:damage} {{name=@{wep1-name}}} {{damage=[[@{wep1-damageroll} + @{wep1-damageflat}]]}} {{dmgcrit=[[@{wep1-critdmg}]]}} {{dmgtype=@{wep1-group}}}"> Damage</button>
                    <select name="attr_wep1-damage" class="wepdamselect">
                        <option value="1d4">1d4 </option>
                        <option value="1d6">1d6 </option>
                        <option value="1d8" selected>1d8 </option>
                        <option value="1d10">1d10</option>
                        <option value="1d12">1d12</option>
                        <option value="2d4">2d4 </option>
                        <option value="2d6">2d6 </option>
                    </select>
                    <input type="hidden" name="attr_wep1-damageroll" value="1d8" />
                    <input type="hidden" name="attr-wep1-damageflat" value="0" />
                    <div class="brutal">
                        <label class="small brutal">
                            <input type="checkbox" name="attr_wep1-brutal" value="r<" /> Brutal
                        </label>
                        <input type="number" name="attr_wep1-brutn" min="1" max="2" value="1" />

                    </div>
                    <label class="small hicrit">
                        <input type="checkbox" name="attr_wep1-highcrit" value="true" />
                        High Crit
                    </label>
                    <input type="hidden" name="attr_wep1-critdmg" value="8" />
                    <label class="small versatile">
                        <input type="checkbox" name="attr_wep1-versatile" value=1/>
                        Versatile
                    </label>
                    <select name="attr_wep1-damage-versatile" class="wepdamselect">
                        <option value="1d4">1d4 </option>
                        <option value="1d6">1d6 </option>
                        <option value="1d8">1d8 </option>
                        <option value="1d10" selected>1d10</option>
                        <option value="1d12">1d12</option>
                        <option value="2d4">2d4 </option>
                        <option value="2d6">2d6 </option>
                    </select>
                </div>
                <textarea name="attr_wep1-description" placeholder="Item Description"
                    placeholder="Use the versatile damage when wielding with two hands; for powers create a copy with the versatile damage, or edit on the fly"></textarea>
            </div>
        </div>
        <div class="weapon">
            <h3>Weapon 2</h3>
            <input type="text" name="attr_wep2-name" class="item" placeholder="Dagger" />
            <input type="checkbox" class="toggle" />
            <div class="body">
                <div class="weapon-left">
                    <button type="roll" class="weaponba"
                        value="&{template:attack} {{name=@{wep2-name}}} {{RangeTargets=@{wep2-range}}} {{attack=[[1d20 + @{wep2-hitbonus}]]}} {{attackadv=[[1d20 + @{wep2-hitbonus}]]}} {{edge=[[1d4]]}} {{defense=AC}}"
                        name="roll_wep2-basic">
                        Basic Attack
                    </button>
                    <input type="text" name="attr_wep2-range" placeholder="Thrown 25'/50'" class="weaponrange" />
                    <select class="attselect" name="attr_wep2-ability">
                        <option value="strmod">Strength</option>
                        <option value="conmod" selected>Constitution</option>
                        <option value="dexmod">Dexterity</option>
                        <option value="intmod">Intelligence</option>
                        <option value="wismod">Wisdom</option>
                        <option value="chamod">Charisma</option>
                    </select>
                    <input type="hidden" name="attr_wep2-abimod" value="0" />
                    <input type="hidden" name="attr_wep2-hitbonus" value="+0" />
                    <label class="small proficiency right">Proficiency
                        <input type="number" name="attr_wep2-prof" value="3" min=0 max=9 /></label>
                    <select class="weapon" name="attr_wep2-group">
                        <option value="Slashing">Axe</option>
                        <option value="Piercing">Bow</option>
                        <option value="Piercing">Crossbow</option>
                        <option value="Piercing">Flail</option>
                        <option value="Bludgeoning">Hammer</option>
                        <option value="Slashing">Heavy Blade</option>
                        <option value="Piercing" selected>Light Blade</option>
                        <option value="Bludgeoning">Mace</option>
                        <option value="Piercing">Pick</option>
                        <option value="Bludgeoning">Sling</option>
                        <option value="Piercing">Spear</option>
                        <option value="Bludgeoning">Staff</option>
                    </select>
                </div>
                <div class="weapon-right">
                    <button type="roll" class="weaponbd"
                        value="&{template:damage} {{name=@{wep2-name}}} {{damage=[[@{wep2-damageroll} + @{wep2-damageflat}]]}} {{dmgcrit=[[@{wep2-critdmg}]]}} {{dmgtype=@{wep2-group}}}"> Damage</button>
                    <select name="attr_wep2-damage" class="wepdamselect">
                        <option value="1d4" selected>1d4 </option>
                        <option value="1d6">1d6 </option>
                        <option value="1d8">1d8 </option>
                        <option value="1d10">1d10</option>
                        <option value="1d12">1d12</option>
                        <option value="2d4">2d4 </option>
                        <option value="2d6">2d6 </option>
                    </select>
                    <input type="hidden" name="attr_wep2-damageroll" value="1d8" />
                    <input type="hidden" name="attr-wep2-damageflat" value="0" />
                    <div class="brutal">
                        <label class="small brutal">
                            <input type="checkbox" name="attr_wep2-brutal" value="r<" /> Brutal
                        </label>
                        <input type="number" name="attr_wep2-brutn" min="1" max="2" value="1" />
                    </div>
                    <label class="small hicrit">
                        <input type="checkbox" name="attr_wep2-highcrit" value="true" />
                        High Crit
                    </label>
                    <input type="hidden" name="attr_wep2-critdmg" value="8" />
                    <label class="small versatile">
                        <input type="checkbox" name="attr_wep2-versatile"  value=1/>
                        Versatile
                    </label>
                    <select name="attr_wep2-damage-versatile" class="wepdamselect">
                        <option value="1d4">1d4 </option>
                        <option value="1d6">1d6 </option>
                        <option value="1d8">1d8 </option>
                        <option value="1d10" selected>1d10</option>
                        <option value="1d12">1d12</option>
                        <option value="2d4">2d4 </option>
                        <option value="2d6">2d6 </option>
                    </select>
                </div>
                <textarea placeholder="Light Thrown, Off-Hand"  name="attr_wep2-description"></textarea>
            </div>
        </div>
        <div class="weapon">
            <h3>Weapon 3</h3>
            <input type="text" name="attr_wep3-name" class="item" placeholder="Crossbow" />
            <input type="checkbox" class="toggle" />
            <div class="body">
                <div class="weapon-left">
                    <button type="roll" class="weaponba"
                        value="&{template:attack} {{name=@{wep3-name}}} {{RangeTargets=@{wep3-range}}} {{attack=[[1d20 + @{wep3-hitbonus}]]}} {{attackadv=[[1d20 + @{wep3-hitbonus}]]}} {{edge=[[1d4]]}} {{defense=AC}}"
                        name="roll_wep3-basic">
                        Basic Attack
                    </button>
                    <input type="text" name="attr_wep3-range" placeholder="Ranged 100'/200'" class="weaponrange" />
                    <select class="attselect" name="attr_wep3-ability">
                        <option value="strmod">Strength</option>
                        <option value="conmod">Constitution</option>
                        <option value="dexmod" selected>Dexterity</option>
                        <option value="intmod">Intelligence</option>
                        <option value="wismod">Wisdom</option>
                        <option value="chamod">Charisma</option>
                    </select>
                    <input type="hidden" name="attr_wep3-abimod" value="0" />
                    <input type="hidden" name="attr_wep3-hitbonus" value="+0" />
                    <label class="small proficiency right">Proficiency
                        <input type="number" name="attr_wep3-prof" value="2" min=0 max=9 /></label>
                    <select class="weapon" name="attr_wep3-group">
                        <option value="Slashing">Axe</option>
                        <option value="Piercing">Bow</option>
                        <option value="Piercing" selected>Crossbow</option>
                        <option value="Piercing">Flail</option>
                        <option value="Bludgeoning">Hammer</option>
                        <option value="Slashing">Heavy Blade</option>
                        <option value="Piercing">Light Blade</option>
                        <option value="Bludgeoning">Mace</option>
                        <option value="Piercing">Pick</option>
                        <option value="Bludgeoning">Sling</option>
                        <option value="Piercing">Spear</option>
                        <option value="Bludgeoning">Staff</option>
                    </select>
                </div>
                <div class="weapon-right">
                    <button type="roll" class="weaponbd"
                        value="&{template:damage} {{name=@{wep3-name}}} {{damage=[[@{wep3-damageroll} + @{wep3-damageflat}]]}} {{dmgcrit=[[@{wep3-critdmg}]]}} {{dmgtype=@{wep3-group}}}"> Damage</button>
                    <select name="attr_wep3-damage" class="wepdamselect">
                        <option value="1d4">1d4 </option>
                        <option value="1d6">1d6 </option>
                        <option value="1d8" selected>1d8 </option>
                        <option value="1d10">1d10</option>
                        <option value="1d12">1d12</option>
                        <option value="2d4">2d4 </option>
                        <option value="2d6">2d6 </option>
                    </select>
                    <input type="hidden" name="attr_wep3-damageroll" value="1d8" />
                    <input type="hidden" name="attr-wep3-damageflat" value="0" />
                    <div class="brutal">
                        <label class="small brutal">
                            <input type="checkbox" name="attr_wep3-brutal" value="r<" /> Brutal
                        </label>
                        <input type="number" name="attr_wep3-brutn" min="1" max="2" value="1" />
                    </div>
                    <label class="small hicrit">
                        <input type="checkbox" name="attr_wep3-highcrit" value="true" />
                        High Crit
                    </label>
                    <input type="hidden" name="attr_wep3-critdmg" value="8" />
                    <label class="small versatile">
                        <input type="checkbox" name="attr_wep3-versatile"  value=1/>
                        Versatile
                    </label>
                    <select name="attr_wep3-damage-versatile" class="wepdamselect">
                        <option value="1d4">1d4 </option>
                        <option value="1d6">1d6 </option>
                        <option value="1d8">1d8 </option>
                        <option value="1d10" selected>1d10</option>
                        <option value="1d12">1d12</option>
                        <option value="2d4">2d4 </option>
                        <option value="2d6">2d6 </option>
                    </select>
                </div>
                <textarea placeholder="Load Minor" name="attr_wep3-description"></textarea>
            </div>
        </div>
        <div class="implement">
            <h3>Implement 1</h3>
            <input type="text" name="attr_imp1-name" class="item" placeholder="Staff" />
            <input type="checkbox" class="toggle" />
            <div class="body">
                <label class="small implement"><input type="number" name="attr_imp1-prof" value="0" /> Attack
                    Bonus</label>
                <input type="hidden" name="attr_imp1-damage" value="1d8" />
                <textarea name="attr_imp1-description" placeholder="Item Description" placeholder="Description"></textarea>
            </div>
        </div>
        <div class="implement">
            <h3>Implement 2</h3>
            <input type="text" name="attr_imp2-name" class="item" placeholder="Wand" />
            <input type="checkbox" class="toggle" />
            <div class="body">
                <label class="small implement"><input type="number" name="attr_imp2-prof" value="0" /> Attack
                    Bonus</label>
                <input type="hidden" name="attr_imp2-damage" value="1d8" />
                <textarea name="attr_imp1-description" placeholder="Item Description" placeholder="Description"></textarea>
            </div>
        </div>
        <div class="armor">
            <h3>Armor</h3>
            <input type="text" name="attr_armoritem-name" value="Cloth" class="item" placeholder="Studded Leather" />
            <input type="checkbox" class="toggle"/>
            <div class="body">
                <label class="small attselect-ac"><select name="attr_ac-att">
                        <option value="0" selected>None (Heavy Armor)</option>
                        <option value="1">Strength</option>
                        <option value="2">Constitution</option>
                        <option value="3">Dexterity</option>
                        <option value="4">Intelligence</option>
                        <option value="5">Wisdom</option>
                        <option value="6">Charisma</option>
                    </select>
                    Attribute</label>
                <label title="Armor Bonus">
                    Armor Bonus <input type="number" name="attr_ac-armor" value="0" /></label>
                <textarea name="attr_armoritem-description" placeholder="Item Description" placeholder="Tough, -1 Armor Check Penalty"></textarea>
            </div>
        </div>
        <div class="otherwornequipment">
            <h3>Other Equipment</h3>
            <div class="worn-other">
                <input type="text" name="attr_headitem-name" placeholder="Head" class="item" />
                <input type="checkbox" class="toggle"/>
                <div class="body">
                    <textarea name="attr_headitem-description" placeholder="Item Description"></textarea>
                </div>
            </div>
            <div class="worn-other">
                <input type="text" name="attr_neckitem-name" placeholder="Neck" class="item" />
                <input type="checkbox" class="toggle" />
                <div class="body">
                    <textarea name="attr_neckitem-description" placeholder="Item Description"></textarea>
                </div>
            </div>
            <div class="worn-other">
                <input type="text" name="attr_armsitem-name" placeholder="Arms" class="item" />
                <input type="checkbox" class="toggle" />
                <div class="body">
                    <label class="numblock shield">
                        Shield Bonus <input type="number" name="attr_shield" value="0" min="0"/>
                    </label>
                    <textarea name="attr_armsitem-description" placeholder="Item Description"></textarea>
                </div>
            </div>
            <div class="worn-other">
                <input type="text" name="attr_handsitem-name" placeholder="Hands" class="item" />
                <input type="checkbox" class="toggle" />
                <div class="body">
                    <textarea name="attr_handsitem-description" placeholder="Item Description"></textarea>
                </div>
            </div>
            <div class="worn-other">
                <input type="text" name="attr_waistitem-name" placeholder="Waist" class="item" />
                <input type="checkbox" class="toggle" />
                <div class="body">
                    <textarea name="attr_waistitem-description" placeholder="Item Description"></textarea>
                </div>
            </div>
            <div class="worn-other">
                <input type="text" name="attr_feetitem-name" placeholder="Feet" class="item" />
                <input type="checkbox" class="toggle" />
                <div class="body">
                    <textarea name="attr_feetitem-description" placeholder="Item Description"></textarea>
                </div>
            </div>
        </div>
    </div>
    <div class="money section">
        <h2>Currency</h2>
        <span name="attr_currency" value="0 gp" style="font-size: 140%"></span>
        <label><input type="number" name="attr_platinum" value=0 /> Platinum Dragons</label>
        <label><input type="number" name="attr_gold" value=0 /> Gold Galifars</label>
        <label><input type="number" name="attr_silver" value=0 /> Silver Sovereigns</label>
        <label><input type="number" name="attr_copper" value=0 /> Copper Crowns</label>
    </div>
    <div class="backpack section">
        <h2>General Equipment</h2>
        <h3>On Person</h3>
        <label>Space: <span name="attr_currentspace" value="0">0</span> / <input type="number" name="attr_maxspace"
                min=0 value=12 class="space"></label>
        <div class="repeatingitemslabels"><span class="left">Name</span><span class="right">Quantity</span></div>
        <fieldset class="repeating_onpersonitems">
            <input type="text" name="attr_onpersonitem" class="item_repeat" placeholder="A day's rations" />
            <input type="number" name="attr_onpersonitem-quantity" value="0" min="0">
            <input type="checkbox" name="attr_onperson-toggle" class="toggle" title="Show Details">
            <div class="body">
                <label><input type="number" name="attr_onpersonitem-space" value="0" step="0.25" /> Space (per)</label>
                <label>
                    Description
                    <textarea name="attr_onpersonitem-description" placeholder="Item Description" placeholder="It's pretty and pink"></textarea>
                </label>
            </div>
        </fieldset>
        <h3>Left at Home</h3>
        <div class="repeatingitemslabels"><span class="left">Name</span><span class="right">Quantity</span></div>
        <fieldset class="repeating_homeitems">
            <input type="text" name="attr_homeitem" class="item_repeat" placeholder="A mystery chest" />
            <input type="number" name="attr_homeitem-quantity" value="0" min="0">
            <input type="checkbox" name="attr_home-toggle" class="toggle" title="Show Details">
            <div class="body">
                <label><input type="number" name="attr_homeitem-space" value="0" step="0.25" /> Space (per)</label>
                <label>
                    Description
                    <textarea name="attr_homeitem-description" placeholder="Item Description" placeholder="Golden and Shiny"></textarea>
                </label>
            </div>
        </fieldset>
    </div>
</div>
<!--Roll Templates-->
<div class="rolltemplates">
    <rolltemplate class="sheet-rolltemplate-attack">
        <table>
            <tr>
                <th>{{ name }}</th>
            </tr>
            <tr>
                <td class="subheader">{{ RangeTargets }}</td>
            </tr>
            <tr class="arrow-container">
                <td>
                    <div class="arrow-right"></div>
                </td>
            </tr>
            <tr class="rowcolor">
                <td>
                    <span class="italic">Attack: </span>{{ attack }} |
                    {{ attackadv }} vs {{ defense }}
                </td>
            </tr>
            <tr>
                <td>Edge: {{edge}}</td>
            </tr>
        </table>
    </rolltemplate>
    <rolltemplate class="sheet-rolltemplate-damage">
        <table>
            <tr>
                <th>{{ name }}</th>
            </tr>
            <tr>
                <td>
                    <span class="italic">Damage: </span>{{ damage }}
                    <span class="italic">Crit: </span>{{ dmgcrit }}
                </td>
            </tr>
            {{#dmgtype}}
            <tr>
                <td><span class="italic">Type: </span>{{ dmgtype }}</td>
            </tr>
            {{/dmgtype}}
        </table>
    </rolltemplate>
    <rolltemplate class="sheet-rolltemplate-skillcheck">
        <table>
            <tr>
                <th>{{ name }}</th>
            </tr>
            <tr>
                <td class="subheader">{{ Trained }}</td>
            </tr>
            <tr class="arrow-container">
                <td>
                    <div class="arrow-right"></div>
                </td>
            </tr>
            <tr class="rowcolor">
                <td>
                    <span class="italic">Check: </span>{{ check }} |
                    {{ checkadv }}
                </td>
            </tr>
        </table>
    </rolltemplate>
    <rolltemplate class="sheet-rolltemplate-powertext">
        <table>
            <tr>
                <th>{{ name }}</th>
            </tr>
            <tr class="arrow-container">
                <td>
                    <div class="arrow-right"></div>
                </td>
            </tr>
            <tr class="rowcolor">
                <td><span class="italic">Text: </span>{{ powertext }}</td>
            </tr>
        </table>
    </rolltemplate>
    <!-- &{template:healing} {{name=Name}} {{dice=[[1d6]]}} {{surge=[[@{target|hp-surgevalue}]]}} {{powertext=Power Text}}-->
    <rolltemplate class="sheet-rolltemplate-healing">
        <table>
            <tr>
                <th>{{ name }}</th>
            </tr>
            <tr class="arrow-container">
                <td>
                    <div class="arrow-right"></div>
                </td>
            </tr>
            <tr class="rowcolor">
                <td>
                    {{#dice}}<span class="italic">Dice:</span> {{dice}} {{/dice}}
                    {{#surge}}<span class="italic">Surge:</span> {{surge}} {{/surge}}
                </td>
            </tr>
            <tr class="rowcolor">
                <td><span class="italic">Text: </span>{{ powertext }}</td>
            </tr>
        </table>
    </rolltemplate>
</div>
<!-- SHEET WORKERS -->
<script type="text/worker">

on("sheet:opened", function () {
    console.log("Sheet opened, JS is running");
});

/********

HELPER FUNCTIONS

********/


function maxdice(damagedice) {
    return parseInt(damagedice) * parseInt(damagedice.slice(damagedice.indexOf("d") + 1));
}

function training(skill) {
    if (skill == 2) {
        return "Adept";
    } else if (skill == 4) {
        return "Trained";
    } else if (skill == 6) {
        return "Experienced";
    } else if (skill == 8) {
        return "Expert";
    } else if (skill == 10) {
        return "Master";
    } else {
        return "Untrained";
    }
}

/********

CORE STATS

********/

on("change:constitution change:hp-base change:hp-level change:hp-bonus change:level", function() {
    getAttrs(["constitution", "hp-base", "hp-level", "hp-bonus", "level"], function(values) {
        hp_max = parseInt(values["constitution"]) + parseInt(values["hp-base"]) + parseInt(values["hp-level"]) * (parseInt(values["level"])-1) + parseInt(values["hp-bonus"])
        setAttrs({
            "hp_max": hp_max,
            "hp-bloodied": Math.floor(hp_max / 2),
            "hp-surgevalue": Math.floor(hp_max / 4)
        })
    })
})

on("change:strength", function () {
    getAttrs(["strength"], function (values) {
        setAttrs({
            strmod: Math.floor(values.strength / 2 - 5)
        });
    });
});

on("change:constitution", function () {
    getAttrs(["constitution"], function (values) {
        setAttrs({
            conmod: Math.floor(values.constitution / 2 - 5)
        });
    });
});

on("change:dexterity", function () {
    getAttrs(["dexterity"], function (values) {
        setAttrs({
            dexmod: Math.floor(values.dexterity / 2 - 5)
        });
    });
});

on("change:intelligence", function () {
    getAttrs(["intelligence"], function (values) {
        setAttrs({
            intmod: Math.floor(values.intelligence / 2 - 5)
        });
    });
});

on("change:wisdom", function () {
    getAttrs(["wisdom"], function (values) {
        setAttrs({
            wismod: Math.floor(values.wisdom / 2 - 5)
        });
    });
});

on("change:charisma", function () {
    getAttrs(["charisma"], function (values) {
        setAttrs({
            chamod: Math.floor(values.charisma / 2 - 5)
        });
    });
});

/********

DEFENSES

********/

on(
    "change:ac-att change:strmod change:conmod change:dexmod change:intmod change:wismod change:chamod  change:quest change:ac-armor change:shield change:ac-misc",
    function () {
        getAttrs(
            [
                "ac-att",
                "strmod",
                "conmod",
                "dexmod",
                "intmod",
                "wismod",
                "chamod",
                "quest",
                "ac-armor",
                "shield",
                "ac-misc"
            ],
            function (values) {
                var abimod = 0;
                switch (parseInt(values["ac-att"])) {
                    case 0:
                        abimod = 0;
                        break;
                    case 1:
                        abimod = values.strmod;
                        break;
                    case 2:
                        abimod = values.conmod;
                        break;
                    case 3:
                        abimod = values.dexmod;
                        break;
                    case 4:
                        abimod = values.intmod;
                        break;
                    case 5:
                        abimod = values.wismod;
                        break;
                    case 6:
                        abimod = values.chamod;
                        break;
                }
                var finalattr =
                    10 +
                    parseInt(abimod) +
                    parseInt(values.quest) +
                    parseInt(values["ac-armor"]) + 
                    parseInt(values["shield"]) +
                    parseInt(values["ac-misc"]);
                setAttrs({
                    AC: finalattr
                });
            }
        );
    }
);

on("change:strmod change:conmod change:quest change:fort-misc", function () {
    getAttrs(["strmod", "conmod", "quest", "fort-misc"], function (values) {
        var finalattr =
            10 +
            Math.max(parseInt(values.strmod), parseInt(values.conmod)) +
            parseInt(values.quest) +
            parseInt(values["fort-misc"]);
        setAttrs({
            "fort": finalattr
        });
    });
});

on("change:dexmod change:intmod change:shield change:quest change:ref-misc", function () {
    getAttrs(["dexmod", "intmod", "quest", "ref-misc", "shield"], function (values) {
        var finalattr =
            10 +
            Math.max(parseInt(values.dexmod), parseInt(values.intmod)) +
            parseInt(values.quest) +
            parseInt(values["shield"]) +
            parseInt(values["ref-misc"]);
        setAttrs({
            "ref": finalattr
        });
    });
});

on("change:wismod change:chamod change:quest change:will-misc", function () {
    getAttrs(["wismod", "chamod", "quest", "will-misc"], function (values) {
        var finalattr =
            10 +
            Math.max(parseInt(values.wismod), parseInt(values.chamod)) +
            parseInt(values.quest) +
            parseInt(values["will-misc"]);
        setAttrs({
            "will": finalattr
        });
    });
});

/********

ATTACKS

********/

on("change:bonusdice-entry", function () {
    getAttrs(["bonusdice-entry"], function (values) {
        setAttrs({
            'bonusdice-crit': maxdice(values["bonusdice-entry"])
        });
    });
});


/* ===STANDARD=== */

on("change:repeating_standard:standard-accessory", function (eventInfo) {
    var accessory = eventInfo.newValue;
    var attack = accessory + "-prof";
    var damageroll = accessory + "-damageroll";
    var crit = accessory + "-critdmg";
    if (accessory.substring(0, 3) == "wep") {
        getAttrs(
            [attack, damageroll, crit],
            function (values) {
                setAttrs({
                    "repeating_standard_standard-hitbonus-accessory": parseInt(
                        values[attack]
                    ),
                    "repeating_standard_standard-damagedice": values[damageroll],
                    "repeating_standard_standard-critdice": values[crit]
                });
            }
        );
    } else {
        getAttrs([attack, "quest"], function (values) {
            var critdice = values["quest"] + "d6";
            setAttrs({
                "repeating_stanard_standard-hitbonus-accessory": parseInt(
                    values[attack]
                ),
                "repeating_standard_standard-critdice": values[critdice]
            });
        });
    }
});

on(
    "change:repeating_standard:standard-ability change:repeating_standard:standard-display",
    function () {
        getAttrs(["repeating_standard_standard-ability"], function (values) {
            var modname = values["repeating_standard_standard-ability"];
            getAttrs([modname], function (values) {
                setAttrs({
                    "repeating_standard_standard-abimod": parseInt(
                        values[modname]
                    )
                });
            });
        });
    }
);

on(
    "change:repeating_standard:standard-miscattackbonus change:repeating_standard:standard-abimod change:repeating_standard:standard-hitbonus-accessory change:repeating_standard:standard-display",
    function () {
        getAttrs(
            [
                "repeating_standard_standard-miscattackbonus",
                "repeating_standard_standard-abimod",
                "repeating_standard_standard-hitbonus-accessory",
                "quest"
            ],
            function (values) {
                var finalattr =
                    parseInt(
                        values["repeating_standard_standard-miscattackbonus"]
                    ) +
                    parseInt(values["repeating_standard_standard-abimod"]) +
                    parseInt(
                        values["repeating_standard_standard-hitbonus-accessory"]
                    ) +
                    parseInt(values["quest"]);
                if (finalattr >= 0) {
                    finalattr = "+" + finalattr;
                } else {
                    finalattr = "-" + finalattr;
                }
                setAttrs({
                    "repeating_standard_standard-hitbonus": finalattr
                });
            }
        );
    }
);

on(
    "change:repeating_standard:standard-miscdamage change:repeating_standard:standard-abidamage change:repeating_standard:standard-abimod change:repeating_standard:standard-display",
    function () {
        getAttrs(
            [
                "repeating_standard_standard-miscdamage",
                "repeating_standard_standard-abidamage",
                "repeating_standard_standard-abimod",
                "quest"
            ],
            function (values) {
                var finalattr =
                    parseInt(values["repeating_standard_standard-abidamage"]) *
                    parseInt(values["repeating_standard_standard-abimod"]) +
                    parseInt(values["quest"]) +
                    parseInt(values["repeating_standard_standard-miscdamage"]);
                if (finalattr >= 0) {
                    finalattr = "+" + finalattr;
                } else {
                    finalattr = "-" + finalattr;
                }
                setAttrs({
                    "repeating_standard_standard-flatdamage": finalattr
                });
            }
        );
    }
);

on("change:repeating_standard:standard-damagedice", function () {
    getAttrs(["repeating_standard_standard-damagedice"], function (values) {
        setAttrs({
            "repeating_standard_standard-critflat": maxdice(values["repeating_standard_standard-damagedice"])
        });
    });
});

/* ===MOVE=== */

on("change:repeating_move:move-accessory", function (eventInfo) {
    var accessory = eventInfo.newValue;
    var attack = accessory + "-prof";
    var damageroll = accessory + "-damageroll";
    var crit = accessory + "-critdmg";
    if (accessory.substring(0, 3) == "wep") {
        getAttrs(
            [attack, damageroll, crit],
            function (values) {
                setAttrs({
                    "repeating_move_move-hitbonus-accessory": parseInt(
                        values[attack]
                    ),
                    "repeating_move_move-damagedice": values[damageroll],
                    "repeating_move_move-critdice": values[crit]
                });
            }
        );
    } else {
        getAttrs([attack, "quest"], function (values) {
            var critdice = values["quest"] + "d6";
            setAttrs({
                "repeating_stanard_move-hitbonus-accessory": parseInt(
                    values[attack]
                ),
                "repeating_move_move-critdice": values[critdice]
            });
        });
    }
});

on(
    "change:repeating_move:move-ability change:repeating_move:move-display",
    function () {
        getAttrs(["repeating_move_move-ability"], function (values) {
            var modname = values["repeating_move_move-ability"];
            getAttrs([modname], function (values) {
                setAttrs({
                    "repeating_move_move-abimod": parseInt(
                        values[modname]
                    )
                });
            });
        });
    }
);

on(
    "change:repeating_move:move-miscattackbonus change:repeating_move:move-abimod change:repeating_move:move-hitbonus-accessory change:repeating_move:move-display",
    function () {
        getAttrs(
            [
                "repeating_move_move-miscattackbonus",
                "repeating_move_move-abimod",
                "repeating_move_move-hitbonus-accessory",
                "quest"
            ],
            function (values) {
                var finalattr =
                    parseInt(
                        values["repeating_move_move-miscattackbonus"]
                    ) +
                    parseInt(values["repeating_move_move-abimod"]) +
                    parseInt(
                        values["repeating_move_move-hitbonus-accessory"]
                    ) +
                    parseInt(values["quest"]);
                if (finalattr >= 0) {
                    finalattr = "+" + finalattr;
                } else {
                    finalattr = "-" + finalattr;
                }
                setAttrs({
                    "repeating_move_move-hitbonus": finalattr
                });
            }
        );
    }
);

on(
    "change:repeating_move:move-miscdamage change:repeating_move:move-abidamage change:repeating_move:move-abimod change:repeating_move:move-display",
    function () {
        getAttrs(
            [
                "repeating_move_move-miscdamage",
                "repeating_move_move-abidamage",
                "repeating_move_move-abimod",
                "quest"
            ],
            function (values) {
                var finalattr =
                    parseInt(values["repeating_move_move-abidamage"]) *
                    parseInt(values["repeating_move_move-abimod"]) +
                    parseInt(values["quest"]) +
                    parseInt(values["repeating_move_move-miscdamage"]);
                if (finalattr >= 0) {
                    finalattr = "+" + finalattr;
                } else {
                    finalattr = "-" + finalattr;
                }
                setAttrs({
                    "repeating_move_move-flatdamage": finalattr
                });
            }
        );
    }
);

on("change:repeating_move:move-damagedice", function () {
    getAttrs(["repeating_move_move-damagedice"], function (values) {
        setAttrs({
            "repeating_move_move-critflat": maxdice(values["repeating_move_move-damagedice"])
        });
    });
});

/* ===MINOR=== */

on("change:repeating_minor:minor-accessory", function (eventInfo) {
    var accessory = eventInfo.newValue;
    var attack = accessory + "-prof";
    var damageroll = accessory + "-damageroll";
    var crit = accessory + "-critdmg";
    if (accessory.substring(0, 3) == "wep") {
        getAttrs(
            [attack, damageroll, crit],
            function (values) {
                setAttrs({
                    "repeating_minor_minor-hitbonus-accessory": parseInt(
                        values[attack]
                    ),
                    "repeating_minor_minor-damagedice": values[damageroll],
                    "repeating_minor_minor-critdice": values[crit]
                });
            }
        );
    } else {
        getAttrs([attack, "quest"], function (values) {
            var critdice = values["quest"] + "d6";
            setAttrs({
                "repeating_stanard_minor-hitbonus-accessory": parseInt(
                    values[attack]
                ),
                "repeating_minor_minor-critdice": values[critdice]
            });
        });
    }
});

on(
    "change:repeating_minor:minor-ability change:repeating_minor:minor-display",
    function () {
        getAttrs(["repeating_minor_minor-ability"], function (values) {
            var modname = values["repeating_minor_minor-ability"];
            getAttrs([modname], function (values) {
                setAttrs({
                    "repeating_minor_minor-abimod": parseInt(
                        values[modname]
                    )
                });
            });
        });
    }
);

on(
    "change:repeating_minor:minor-miscattackbonus change:repeating_minor:minor-abimod change:repeating_minor:minor-hitbonus-accessory change:repeating_minor:minor-display",
    function () {
        getAttrs(
            [
                "repeating_minor_minor-miscattackbonus",
                "repeating_minor_minor-abimod",
                "repeating_minor_minor-hitbonus-accessory",
                "quest"
            ],
            function (values) {
                var finalattr =
                    parseInt(
                        values["repeating_minor_minor-miscattackbonus"]
                    ) +
                    parseInt(values["repeating_minor_minor-abimod"]) +
                    parseInt(
                        values["repeating_minor_minor-hitbonus-accessory"]
                    ) +
                    parseInt(values["quest"]);
                if (finalattr >= 0) {
                    finalattr = "+" + finalattr;
                } else {
                    finalattr = "-" + finalattr;
                }
                setAttrs({
                    "repeating_minor_minor-hitbonus": finalattr
                });
            }
        );
    }
);

on(
    "change:repeating_minor:minor-miscdamage change:repeating_minor:minor-abidamage change:repeating_minor:minor-abimod change:repeating_minor:minor-display",
    function () {
        getAttrs(
            [
                "repeating_minor_minor-miscdamage",
                "repeating_minor_minor-abidamage",
                "repeating_minor_minor-abimod",
                "quest"
            ],
            function (values) {
                var finalattr =
                    parseInt(values["repeating_minor_minor-abidamage"]) *
                    parseInt(values["repeating_minor_minor-abimod"]) +
                    parseInt(values["quest"]) +
                    parseInt(values["repeating_minor_minor-miscdamage"]);
                if (finalattr >= 0) {
                    finalattr = "+" + finalattr;
                } else {
                    finalattr = "-" + finalattr;
                }
                setAttrs({
                    "repeating_minor_minor-flatdamage": finalattr
                });
            }
        );
    }
);

on("change:repeating_minor:minor-damagedice", function () {
    getAttrs(["repeating_minor_minor-damagedice"], function (values) {
        setAttrs({
            "repeating_minor_minor-critflat": maxdice(values["repeating_minor_minor-damagedice"])
        });
    });
});

/* ===REACTION=== */

on("change:repeating_reaction:reaction-accessory", function (eventInfo) {
    var accessory = eventInfo.newValue;
    var attack = accessory + "-prof";
    var damageroll = accessory + "-damageroll";
    var crit = accessory + "-critdmg";
    if (accessory.substring(0, 3) == "wep") {
        getAttrs(
            [attack, damageroll, crit],
            function (values) {
                setAttrs({
                    "repeating_reaction_reaction-hitbonus-accessory": parseInt(
                        values[attack]
                    ),
                    "repeating_reaction_reaction-damagedice": values[damageroll],
                    "repeating_reaction_reaction-critdice": values[crit]
                });
            }
        );
    } else {
        getAttrs([attack, "quest"], function (values) {
            var critdice = values["quest"] + "d6";
            setAttrs({
                "repeating_stanard_reaction-hitbonus-accessory": parseInt(
                    values[attack]
                ),
                "repeating_reaction_reaction-critdice": values[critdice]
            });
        });
    }
});

on(
    "change:repeating_reaction:reaction-ability change:repeating_reaction:reaction-display",
    function () {
        getAttrs(["repeating_reaction_reaction-ability"], function (values) {
            var modname = values["repeating_reaction_reaction-ability"];
            getAttrs([modname], function (values) {
                setAttrs({
                    "repeating_reaction_reaction-abimod": parseInt(
                        values[modname]
                    )
                });
            });
        });
    }
);

on(
    "change:repeating_reaction:reaction-miscattackbonus change:repeating_reaction:reaction-abimod change:repeating_reaction:reaction-hitbonus-accessory change:repeating_reaction:reaction-display",
    function () {
        getAttrs(
            [
                "repeating_reaction_reaction-miscattackbonus",
                "repeating_reaction_reaction-abimod",
                "repeating_reaction_reaction-hitbonus-accessory",
                "quest"
            ],
            function (values) {
                var finalattr =
                    parseInt(
                        values["repeating_reaction_reaction-miscattackbonus"]
                    ) +
                    parseInt(values["repeating_reaction_reaction-abimod"]) +
                    parseInt(
                        values["repeating_reaction_reaction-hitbonus-accessory"]
                    ) +
                    parseInt(values["quest"]);
                if (finalattr >= 0) {
                    finalattr = "+" + finalattr;
                } else {
                    finalattr = "-" + finalattr;
                }
                setAttrs({
                    "repeating_reaction_reaction-hitbonus": finalattr
                });
            }
        );
    }
);

on(
    "change:repeating_reaction:reaction-miscdamage change:repeating_reaction:reaction-abidamage change:repeating_reaction:reaction-abimod change:repeating_reaction:reaction-display",
    function () {
        getAttrs(
            [
                "repeating_reaction_reaction-miscdamage",
                "repeating_reaction_reaction-abidamage",
                "repeating_reaction_reaction-abimod",
                "quest"
            ],
            function (values) {
                var finalattr =
                    parseInt(values["repeating_reaction_reaction-abidamage"]) *
                    parseInt(values["repeating_reaction_reaction-abimod"]) +
                    parseInt(values["quest"]) +
                    parseInt(values["repeating_reaction_reaction-miscdamage"]);
                if (finalattr >= 0) {
                    finalattr = "+" + finalattr;
                } else {
                    finalattr = "-" + finalattr;
                }
                setAttrs({
                    "repeating_reaction_reaction-flatdamage": finalattr
                });
            }
        );
    }
);

on("change:repeating_reaction:reaction-damagedice", function () {
    getAttrs(["repeating_reaction_reaction-damagedice"], function (values) {
        setAttrs({
            "repeating_reaction_reaction-critflat": maxdice(values["repeating_reaction_reaction-damagedice"])
        });
    });
});

/********

SKILLS

********/

on(
    "change:acrobatics-train change:acrobatics-miscbonus change:dexmod change:quest",
    function () {
        getAttrs(
            ["acrobatics-train", "acrobatics-miscbonus", "dexmod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["acrobatics-train"]) +
                    parseInt(values["acrobatics-miscbonus"]) +
                    parseInt(values["dexmod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Acrobatics: finalattr
                });
            }
        );
    }
);

on(
    "change:appeal-train change:appeal-miscbonus change:chamod change:quest",
    function () {
        getAttrs(
            ["appeal-train", "appeal-miscbonus", "chamod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["appeal-train"]) +
                    parseInt(values["appeal-miscbonus"]) +
                    parseInt(values["chamod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Appeal: finalattr
                });
            }
        );
    }
);

on(
    "change:arcana-train change:arcana-miscbonus change:intmod change:quest",
    function () {
        getAttrs(
            ["arcana-train", "arcana-miscbonus", "intmod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["arcana-train"]) +
                    parseInt(values["arcana-miscbonus"]) +
                    parseInt(values["intmod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Arcana: finalattr
                });
            }
        );
    }
);

on(
    "change:athletics-train change:athletics-miscbonus change:strmod change:quest",
    function () {
        getAttrs(
            ["athletics-train", "athletics-miscbonus", "strmod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["athletics-train"]) +
                    parseInt(values["athletics-miscbonus"]) +
                    parseInt(values["strmod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Athletics: finalattr
                });
            }
        );
    }
);

on(
    "change:debate-train change:debate-miscbonus change:intmod change:quest",
    function () {
        getAttrs(
            ["debate-train", "debate-miscbonus", "intmod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["debate-train"]) +
                    parseInt(values["debate-miscbonus"]) +
                    parseInt(values["intmod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Debate: finalattr
                });
            }
        );
    }
);

on(
    "change:endurance-train change:endurance-miscbonus change:conmod change:quest",
    function () {
        getAttrs(
            ["endurance-train", "endurance-miscbonus", "conmod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["endurance-train"]) +
                    parseInt(values["endurance-miscbonus"]) +
                    parseInt(values["conmod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Endurance: finalattr
                });
            }
        );
    }
);

on(
    "change:handleanimal-train change:handleanimal-miscbonus change:wismod change:quest",
    function () {
        getAttrs(
            ["handleanimal-train", "handleanimal-miscbonus", "wismod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["handleanimal-train"]) +
                    parseInt(values["handleanimal-miscbonus"]) +
                    parseInt(values["wismod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    HandleAnimal: finalattr
                });
            }
        );
    }
);

on(
    "change:impress-train change:impress-miscbonus change:chamod change:quest",
    function () {
        getAttrs(
            ["impress-train", "impress-miscbonus", "chamod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["impress-train"]) +
                    parseInt(values["impress-miscbonus"]) +
                    parseInt(values["chamod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Impress: finalattr
                });
            }
        );
    }
);

on(
    "change:insight-train change:insight-miscbonus change:wismod change:quest",
    function () {
        getAttrs(
            ["insight-train", "insight-miscbonus", "wismod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["insight-train"]) +
                    parseInt(values["insight-miscbonus"]) +
                    parseInt(values["wismod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Insight: finalattr
                });
            }
        );
    }
);

on(
    "change:medicine-train change:medicine-miscbonus change:wismod change:quest",
    function () {
        getAttrs(
            ["medicine-train", "medicine-miscbonus", "wismod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["medicine-train"]) +
                    parseInt(values["medicine-miscbonus"]) +
                    parseInt(values["wismod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Medicine: finalattr
                });
            }
        );
    }
);

on(
    "change:perception-train change:perception-miscbonus change:wismod change:quest",
    function () {
        getAttrs(
            ["perception-train", "perception-miscbonus", "wismod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["perception-train"]) +
                    parseInt(values["perception-miscbonus"]) +
                    parseInt(values["wismod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Perception: finalattr
                });
            }
        );
    }
);

on(
    "change:repair-train change:repair-miscbonus change:intmod change:quest",
    function () {
        getAttrs(
            ["repair-train", "repair-miscbonus", "intmod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["repair-train"]) +
                    parseInt(values["repair-miscbonus"]) +
                    parseInt(values["intmod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Repair: finalattr
                });
            }
        );
    }
);

on(
    "change:research-train change:research-miscbonus change:intmod change:quest",
    function () {
        getAttrs(
            ["research-train", "research-miscbonus", "intmod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["research-train"]) +
                    parseInt(values["research-miscbonus"]) +
                    parseInt(values["intmod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Research: finalattr
                });
            }
        );
    }
);

on(
    "change:sleightofhand-train change:sleightofhand-miscbonus change:dexmod change:quest",
    function () {
        getAttrs(
            [
                "sleightofhand-train",
                "sleightofhand-miscbonus",
                "dexmod",
                "quest"
            ],
            function (values) {
                var finalattr =
                    parseInt(values["sleightofhand-train"]) +
                    parseInt(values["sleightofhand-miscbonus"]) +
                    parseInt(values["dexmod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    SleightofHand: finalattr
                });
            }
        );
    }
);

on(
    "change:stealth-train change:stealth-miscbonus change:dexmod change:quest",
    function () {
        getAttrs(
            ["stealth-train", "stealth-miscbonus", "dexmod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["stealth-train"]) +
                    parseInt(values["stealth-miscbonus"]) +
                    parseInt(values["dexmod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Stealth: finalattr
                });
            }
        );
    }
);

on(
    "change:socialize-train change:socialize-miscbonus change:chamod change:quest",
    function () {
        getAttrs(
            ["socialize-train", "socialize-miscbonus", "chamod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["socialize-train"]) +
                    parseInt(values["socialize-miscbonus"]) +
                    parseInt(values["chamod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Socialize: finalattr
                });
            }
        );
    }
);

on(
    "change:survival-train change:survival-miscbonus change:wismod change:quest",
    function () {
        getAttrs(
            ["survival-train", "survival-miscbonus", "wismod", "quest"],
            function (values) {
                var finalattr =
                    parseInt(values["survival-train"]) +
                    parseInt(values["survival-miscbonus"]) +
                    parseInt(values["wismod"]) +
                    parseInt(values["quest"]);
                if (finalattr > 0) {
                    finalattr = "+" + finalattr;
                }
                setAttrs({
                    Survival: finalattr
                });
            }
        );
    }
);

on("change:acrobatics-train", function () {
    getAttrs(["acrobatics-train"], function (values) {
        setAttrs({
            "acrobatics-trained": training(values["acrobatics-train"])
        });
    });
});

on("change:appeal-train", function () {
    getAttrs(["appeal-train"], function (values) {
        setAttrs({
            "appeal-trained": training(values["appeal-train"])
        });
    });
});

on("change:arcana-train", function () {
    getAttrs(["arcana-train"], function (values) {
        setAttrs({
            "arcana-trained": training(values["arcana-train"])
        });
    });
});

on("change:athletics-train", function () {
    getAttrs(["athletics-train"], function (values) {
        setAttrs({
            "athletics-trained": training(values["athletics-train"])
        });
    });
});

on("change:debate-train", function () {
    getAttrs(["debate-train"], function (values) {
        setAttrs({
            "debate-trained": training(values["debate-train"])
        });
    });
});

on("change:endurance-train", function () {
    getAttrs(["endurance-train"], function (values) {
        setAttrs({
            "endurance-trained": training(values["endurance-train"])
        });
    });
});

on("change:handleanimal-train", function () {
    getAttrs(["handleanimal-train"], function (values) {
        setAttrs({
            "handleanimal-trained": training(values["handleanimal-train"])
        });
    });
});

on("change:impress-train", function () {
    getAttrs(["impress-train"], function (values) {
        setAttrs({
            "impress-trained": training(values["impress-train"])
        });
    });
});

on("change:insight-train", function () {
    getAttrs(["insight-train"], function (values) {
        setAttrs({
            "insight-trained": training(values["insight-train"])
        });
    });
});

on("change:medicine-train", function () {
    getAttrs(["medicine-train"], function (values) {
        setAttrs({
            "medicine-trained": training(values["medicine-train"])
        });
    });
});

on("change:perception-train", function () {
    getAttrs(["perception-train"], function (values) {
        setAttrs({
            "perception-trained": training(values["perception-train"])
        });
    });
});

on("change:repair-train", function () {
    getAttrs(["repair-train"], function (values) {
        setAttrs({
            "repair-trained": training(values["repair-train"])
        });
    });
});

on("change:research-train", function () {
    getAttrs(["research-train"], function (values) {
        setAttrs({
            "research-trained": training(values["research-train"])
        });
    });
});

on("change:sleightofhand-train", function () {
    getAttrs(["sleightofhand-train"], function (values) {
        setAttrs({
            "sleightofhand-trained": training(values["sleightofhand-train"])
        });
    });
});

on("change:stealth-train", function () {
    getAttrs(["stealth-train"], function (values) {
        setAttrs({
            "stealth-trained": training(values["stealth-train"])
        });
    });
});

on("change:socialize-train", function () {
    getAttrs(["socialize-train"], function (values) {
        setAttrs({
            "socialize-trained": training(values["socialize-train"])
        });
    });
});

on("change:survival-train", function () {
    getAttrs(["survival-train"], function (values) {
        setAttrs({
            "survival-trained": training(values["survival-train"])
        });
    });
});

on("change:repeating_onpersonitems:onpersonitem-quantity change:repeating_onpersonitems:onpersonitem-space", function () {
    getSectionIDs("onpersonitems", function (idarray) {
        var totalSpace = 0;
        var quantArray = [];
        var sizeArray = [];
        for (var i = 0; i < idarray.length; i++) {
            quantArray.push("repeating_onpersonitems_" + idarray[i] + "_onpersonitem-quantity");
            sizeArray.push("repeating_onpersonitems_" + idarray[i] + "_onpersonitem-space");
        }
        getAttrs(quantArray.concat(sizeArray), function (values) {
            for (i = 0; i < idarray.length; i++) {
                totalSpace += values[quantarray[i]] * values[sizearray[i]];
            }
            setAttrs({
                currentSpace: totalSpace
            })
        });
    });
});


/********

WEAPONS

********/

on(
    "change:wep1-ability change:wep2-ability change:wep3-ability change:strmod change:conmod change:dexmod change:intmod change:wismod change:chamod",
    function () {
        getAttrs(["wep1-ability", "wep2-ability", "wep3-ability"], function (values) {
            var wep1mod = values["wep1-ability"];
            var wep2mod = values["wep2-ability"];
            var wep3mod = values["wep3-ability"];
            getAttrs([wep1mod, wep2mod, wep3mod], function (values) {
                setAttrs({
                    "wep1-abimod": parseInt(
                        values[wep1mod]
                    ),
                    "wep2-abimod": parseInt(
                        values[wep2mod]
                    ),
                    "wep3-abimod": parseInt(
                        values[wep3mod]
                    ),
                });
            });
        });
    }
);

on("change:wep1-abimod change:wep1-prof change:quest", function () {
    getAttrs(["wep1-abimod", "wep1-prof", "quest"], function (v) {
        setAttrs({
            "wep1-hitbonus": parseInt(v["wep1-abimod"]) + parseInt(v["wep1-prof"]) + parseInt(v["quest"]),
            "wep1-damageflat": parseInt(v["wep1-abimod"]) + parseInt(v["quest"])
        })
    })
});

on("change:wep1-damage change:wep1-damage-versatile change:wep1-versatile change:wep1-brutal change:wep1-brutn change:wep1-highcrit change:wep1-damageflat change:level", function () {
    getAttrs(["wep1-damage", "wep1-damage-versatile", "wep1-versatile", "wep1-brutal", "wep1-brutn", "wep1-highcrit", "wep1-damageflat", "level", "quest"], function (v) {
        var damagedice = v["wep1-damage"];
        numdice = parseInt(damagedice);
        diesize = "d" + String(maxdice(damagedice) / numdice)
        if (v["wep1-versatile"] == 1) {
            damagedice = v["wep1-damage-versatile"];
        }
        brutal = "";
        if (v["wep1-brutal"] == "r<") {
            brutal = v["wep1-brutal"] + v["wep1-brutn"]
        }
        highcrit = ""
        if (v["wep1-highcrit"] == "true") {
            numdice = parseInt(damagedice);
            highcrit = String(Math.ceil(v["level"] / 5) * numdice) + diesize + " + ";
        }
        damagedice = String(Math.ceil(v["level"] / 10) * numdice) + diesize
        setAttrs({
            "wep1-damageroll": damagedice + brutal,
            "wep1-critdmg": highcrit + v["quest"] + "d6 + " + String(maxdice(damagedice) + v["wep1-damageflat"])
        });
    });
});



on("change:wep2-abimod change:wep2-prof change:quest", function () {
    getAttrs(["wep2-abimod", "wep2-prof", "quest"], function (v) {
        setAttrs({
            "wep2-hitbonus": parseInt(v["wep2-abimod"]) + parseInt(v["wep2-prof"]) + parseInt(v["quest"]),
            "wep2-damageflat": parseInt(v["wep2-abimod"]) + parseInt(v["quest"])
        })
    })
});

on("change:wep2-damage change:wep2-damage-versatile change:wep2-versatile change:wep2-brutal change:wep2-brutn change:wep2-highcrit change:wep2-damageflat change:level", function () {
    getAttrs(["wep2-damage", "wep2-damage-versatile", "wep2-versatile", "wep2-brutal", "wep2-brutn", "wep2-highcrit", "wep2-damageflat", "level", "quest"], function (v) {
        var damagedice = v["wep2-damage"];
        numdice = parseInt(damagedice);
        diesize = "d" + String(maxdice(damagedice) / numdice)
        if (v["wep2-versatile"] == 1) {
            damagedice = v["wep2-damage-versatile"];
        }
        brutal = "";
        if (v["wep2-brutal"] == "r<") {
            brutal = v["wep2-brutal"] + v["wep2-brutn"]
        }
        highcrit = ""
        if (v["wep2-highcrit"] == "true") {
            numdice = parseInt(damagedice);
            highcrit = String(Math.ceil(v["level"] / 5) * numdice) + diesize + " + ";
        }
        damagedice = String(Math.ceil(v["level"] / 10) * numdice) + diesize
        setAttrs({
            "wep2-damageroll": damagedice + brutal,
            "wep2-critdmg": highcrit + v["quest"] + "d6 + " + String(maxdice(damagedice) + v["wep2-damageflat"])
        });
    });
});


on("change:wep3-abimod change:wep3-prof change:quest", function () {
    getAttrs(["wep3-abimod", "wep3-prof", "quest"], function (v) {
        setAttrs({
            "wep3-hitbonus": parseInt(v["wep3-abimod"]) + parseInt(v["wep3-prof"]) + parseInt(v["quest"]),
            "wep3-damageflat": parseInt(v["wep3-abimod"]) + parseInt(v["quest"])
        })
    })
});

on("change:wep3-damage change:wep3-damage-versatile change:wep3-versatile change:wep3-brutal change:wep3-brutn change:wep3-highcrit change:wep3-damageflat change:level", function () {
    getAttrs(["wep3-damage", "wep3-damage-versatile", "wep3-versatile", "wep3-brutal", "wep3-brutn", "wep3-highcrit", "wep3-damageflat", "level", "quest"], function (v) {
        var damagedice = v["wep3-damage"];
        numdice = parseInt(damagedice);
        diesize = "d" + String(maxdice(damagedice) / numdice)
        if (v["wep3-versatile"] == 1) {
            damagedice = v["wep3-damage-versatile"];
        }
        brutal = "";
        if (v["wep3-brutal"] == "r<") {
            brutal = v["wep3-brutal"] + v["wep3-brutn"]
        }
        highcrit = ""
        if (v["wep3-highcrit"] == "true") {
            numdice = parseInt(damagedice);
            highcrit = String(Math.ceil(v["level"] / 5) * numdice) + diesize + " + ";
        }
        damagedice = String(Math.ceil(v["level"] / 10) * numdice) + diesize
        setAttrs({
            "wep3-damageroll": damagedice + brutal,
            "wep3-critdmg": highcrit + v["quest"] + "d6 + " + String(maxdice(damagedice) + v["wep3-damageflat"])
        });
    });
});

</script>